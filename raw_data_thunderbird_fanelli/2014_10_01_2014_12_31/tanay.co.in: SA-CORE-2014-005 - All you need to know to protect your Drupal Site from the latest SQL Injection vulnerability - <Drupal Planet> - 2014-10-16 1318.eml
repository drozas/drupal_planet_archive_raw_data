X-Mozilla-Status: 0041
X-Mozilla-Status2: 00000000
X-Mozilla-Keys:                                                                                
Date: Thu, 16 Oct 2014 11:18:08 +0000
Message-Id: <http://drupal.org/planet/rss.xml#Thu, 16 Oct 2014 11:18:08 +0000@localhost.localdomain>
From: <Drupal Planet>
MIME-Version: 1.0
Subject: tanay.co.in: SA-CORE-2014-005 - All you need to know to protect your Drupal Site from the latest SQL Injection vulnerability
Content-Transfer-Encoding: 8bit
Content-Base: http://www.tanay.co.in/blog/sa-core-2014-005-all-you-need-know-protect-your-drupal-site-latest-sql-injection-vulnerability
Content-Type: text/html; charset=UTF-8

<html>
  <head>
    <title>tanay.co.in: SA-CORE-2014-005 - All you need to know to protect your Drupal Site from the latest SQL Injection vulnerability</title>
    <base href="http://www.tanay.co.in/blog/sa-core-2014-005-all-you-need-know-protect-your-drupal-site-latest-sql-injection-vulnerability">
  </head>
  <body id="msgFeedSummaryBody" selected="false">
    <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Last night, Drupal Release a security update to its core - </span><a href="https://www.drupal.org/drupal-7.32-release-notes"><span style="font-size: 15px; font-family: Arial; color: rgb(17, 85, 204); font-style: normal; font-variant: normal; text-decoration: underline; white-space: pre-wrap; background-color: transparent;">v7.32</span></a><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;"> </span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"> </p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">The release addresses the SQL Injection vulnerability described at </span><a href="https://www.drupal.org/SA-CORE-2014-005"><span style="font-size: 15px; font-family: Arial; color: rgb(17, 85, 204); font-style: normal; font-variant: normal; text-decoration: underline; white-space: pre-wrap; background-color: transparent;">https://www.drupal.org/SA-CORE-2014-005</span></a></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;">
	 </p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;"><img height="391px;" src="/sites/default/files/cdn/2014/10/16/qGjH9efhrdnZBcoDhFwOmAnPMmFADGh-bfQQVdqTnNeS-VlOqrseVpA7NmLqLnS2wrj83NteGeCzHtlRoMPS6csHpmpybLhh0iw7orapjnaOvqlhkf7HM8-RQbhubXkbwQ" style="border-style: none; transform: rotate(0rad); -webkit-transform: rotate(0rad);" width="624px;" /></span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;">
	 </p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">How serious is it?</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">There are many proof of concepts scripts available all over the internet now. I have tried a couple of those python scripts and literally anyone who can execute a python script can now login to your </span><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Drupal 7</span><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;"> Site as admin, or execute any SQL on your Drupal Database!</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 11px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">[I am not linking them here for the obvious reasons, if you came here searching for those scripts, you are at the wrong place]</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"> </p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">So, is my site vulnerable?</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Most of the Drupal-special webhosts like Acquia, Pantheon, Platform.sh have apparently patched their platforms protecting your Drupal site even if your individual site has not been patched yet. So most of you are safe. You should be worried if you are hosting on one of those generic hosts to whom Drupal is just yet another script or if you are running the site on your own stack.</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"> </p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">How do I fix my Site?</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Don’t worry. Fortunately it is very simple. And it would not take more than 2 minutes to fix your site (if you do it via #3 below).</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"> </p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-weight: bold; font-style: normal; font-variant: normal; text-decoration: underline; white-space: pre-wrap; background-color: transparent;">If the words like “git”, “patch”, “upgrade” scare you and if you like the words “FTP”, “Filezilla” more then skip directly to #3 below</span><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; text-decoration: underline; white-space: pre-wrap; background-color: transparent;">.</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"> </p>
<ul style="margin-top:0pt;margin-bottom:0pt;">
<li dir="ltr" style="list-style-type: disc; font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">OPTION #1: </span><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">The first option is to update your site to the latest version of Drupal - 7.32. </span></span></p>
</li>
<li dir="ltr" style="list-style-type: disc; font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">OPTION #2:</span><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">But yeah, there is considerable effort involved behind upgrading your Drupal Site. Every upgrade usually would require significant regression testing and this could take a while. </span><br class="kix-line-break" /><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">So, as an alternative, there is a very small patch out there for  you. Apply it and you are all set.</span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Patch : </span><a href="https://www.drupal.org/files/issues/SA-CORE-2014-005-D7.patch"><span style="font-size: 15px; font-family: Arial; color: rgb(17, 85, 204); font-weight: bold; font-style: normal; font-variant: normal; text-decoration: underline; white-space: pre-wrap; background-color: transparent;">https://www.drupal.org/files/issues/SA-CORE-2014-005-D7.patch</span></a><br class="kix-line-break" /><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">How do I apply this patch?</span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Like any other patch - </span></span></p>
<ul style="margin-top:0pt;margin-bottom:0pt;">
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">SSH To your drupal root directory</span></span></p>
</li>
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Get the patch by executing the command</span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: italic; font-variant: normal; white-space: pre-wrap; background-color: transparent;">wget <a href="http://www.drupal.org/files/issues/SA-CORE-2014-005-D7.patch">http://www.drupal.org/files/issues/SA-CORE-2014-005-D7.patch</a></span></span></p>
</li>
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Assuming you got git on the server, run the command</span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: italic; font-variant: normal; white-space: pre-wrap; background-color: transparent;">git apply -v SA-CORE-2014-005-D7.patch</span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;"><img height="64px;" src="/sites/default/files/cdn/2014/10/16/SPjSJJ8s6Q9BZiT6NewBr7BKMb0kEOquNFlmxB13RI68hwhAAuKsWsv37VP9OqsIyfaxtYg9iozbBwCoqJEPsH4SKw-2_dfDQYpANtFx5KYyvrdAmaEsZRJExk7-Vt7r3A" style="border-style: none; transform: rotate(0rad); -webkit-transform: rotate(0rad);" width="624px;" /></span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">If you see something like this, you are all set now :-)</span></span><br class="kix-line-break" /><br />
					 </p>
</li>
</ul>
</li>
<li dir="ltr" style="list-style-type: disc; font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">OPTION #3: [THE SIMPLEST OF ALL] </span><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Alternatively, if you do not want to deal with patches or upgrades, or if you are are looking for a quick fix, here you go:</span></span></p>
<ul style="margin-top:0pt;margin-bottom:0pt;">
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">FTP to, or open your Drupal Root Directory</span></span></p>
</li>
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Navigate to  </span><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">includes/database/</span><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;"> folder</span></span></p>
</li>
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">There will be a file named </span><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">database.inc</span><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;"> . Take a backup of the file. We are going to modify the file. Store the backup somewhere safe just in case.</span></span></p>
</li>
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Open the file </span><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">database.inc</span><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;"> . </span></span></p>
</li>
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">At around</span><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;"> line 739</span><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">, you will find a line of code that reads</span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: italic; font-variant: normal; white-space: pre-wrap; background-color: transparent;">foreach ($data as $i =&gt; $value) {</span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Replace this line with</span><br class="kix-line-break" /><span style="font-size: 15px; font-family: Arial; font-weight: bold; font-style: italic; font-variant: normal; white-space: pre-wrap; background-color: transparent;">foreach (array_values($data) as $i =&gt; $value) {</span></span></p>
</li>
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Save the file and exit</span></span></p>
</li>
<li dir="ltr" style="list-style-type: square; font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal;">
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Pat yourself on the back. You are all set now :-)</span></span></p>
</li>
</ul>
</li>
</ul>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"> </p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><br class="kix-line-break" /><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">I have no enemies. Should I still fix my site?</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Absolutely yes. With the many google dorks that could be used to find Drupal Sites, you could be the subject of random attack. - ie Some noob with the script picking up your site randomly to login as admin and defacing it or playing around with it, or stealing your userbase for spamming!</span></span></p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"> </p>
<p dir="ltr" style="line-height:1.5;margin-top:0pt;margin-bottom:0pt;"><span id="docs-internal-guid-10318073-18bf-a763-2c03-80ef182fd4c8"><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-weight: bold; font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Who found this issue? Who reported it? When was it first reported? ……. </span><span style="font-size: 15px; font-family: Arial; color: rgb(0, 0, 0); font-style: normal; font-variant: normal; white-space: pre-wrap; background-color: transparent;">Check out the FAQ on Drupal.org for answers - </span><span style="font-size: 15px; font-family: Arial; color: rgb(17, 85, 204); font-weight: bold; font-style: normal; font-variant: normal; text-decoration: underline; white-space: pre-wrap; background-color: transparent;"><a href="https://www.drupal.org/node/2357241">https://www.drupal.org/node/2357241</a></span></span></p>
<div>
	 </div>
</div></div></div>
  </body>
</html>

